<% should_show_api_call_button = true %>




<div class="container">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center my-4">
        <h3 class="float-left mb-0">Transactions</h3>
        <button id="create_transaction_btn" class="btn btn-gold float-right">ADD TRANSACTIONS</button>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-2">TRANSACTION</div>
    <div class="col-2">VALUE IN USD</div>
    <div class="col-2">VALUE IN FRC</div>
    <div class="col-2">PRICE ORACLE</div>
    <div class="col-3">COMMISSION %</div>
  </div>
</div>

<div id="transaction_list" class="" data-simple-table data-url="/api/economy/transaction/kind/list">
  <script type="text/x-handlebars-template" data-row-template>
    <div class="container" style="margin-top: 15px; margin-bottom: 15px">
      <div class="row align-items-center py-3 rounded ost-table-row" style="background-color: #f1f5f8;">
        <div class="col-2">{{name}}<br/>User to Company{{kind_display_text}}</div>
        <div class="col-2 text-center">${{value_in_usd}}</div>
        <div class="col-2 text-center">{{value_in_bt}}</div>
        <div class="col-2 text-center">{{price_oracle_text}}</div>
        <div class="col-1 text-center">{{commission_percent}}&#37;</div>
        <div class="col-3 text-center">
          {{#IfShowApiCallButton id }}
            <button class="showApiCallBtn btn btn-info" >API Call</button> 
          {{/IfShowApiCallButton}}
          <button class="editRow btn btn-default" data-result-id="{{id}}">Edit</button>
          <input type="hidden" name="id" value={{id}}/>
          <input type="hidden" name="uts" value={{uts}}/>
        </div>
      </div>
    </div>
  </script>
</div>

<% content_for :end_js do %>
  <script type="text/javascript" 
    src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.js"></script>

  <script type="text/javascript">
    Handlebars.registerHelper('price_oracle_text', function(response, options ) { 

      var rowData = response.data.root || {};
      return rowData.use_price_oracle ? "Yes" : "No";
      return "YES";
    });

    var kindDisplayText = {
      "user_to_company": "User to Company",
      "user_to_user": "User to User",
      "company_to_user": "Company to User"
    };

    Handlebars.registerHelper('kind_display_text', function(response, options ) { 
      var rowData = response.data.root || {}
        , kind    = rowData.kind
      ;

      return kindDisplayText[ kind ];
    });

    Handlebars.registerHelper('IfShowApiCallButton', function(data, options ) { 
      console.log("IfShowApiCallButton called!", arguments); 
      if (<%= should_show_api_call_button %>) {
        return options.fn(this);
      } else {
        return options.inverse(this);
      }
    });
    ost.transactions.init({
    
    });  
  </script>
<% end %>